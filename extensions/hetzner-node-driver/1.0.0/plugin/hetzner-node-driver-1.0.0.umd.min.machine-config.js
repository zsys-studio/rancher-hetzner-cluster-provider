(("undefined"!==typeof self?self:this)["webpackChunkhetzner_node_driver_1_0_0"]=("undefined"!==typeof self?self:this)["webpackChunkhetzner_node_driver_1_0_0"]||[]).push([[921],{8422:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return $}});var t=a(9274);const i={key:1},s={key:2},r={class:"row mt-20"},o={class:"col span-6"},n={class:"col span-6"},d={class:"row mt-20"},c={class:"col span-6"},u={class:"col span-6 pt-5"},h={key:0,class:"row mt-20"},v={class:"col span-6"},m={class:"row mt-20"},p={class:"col span-12"},b={key:1,class:"row mt-10"},w={class:"col span-6"},f={key:2,class:"row mt-10"},g={class:"col span-6"},y={class:"col span-6 pt-5"},N={class:"text-muted mt-5"},k={key:3,class:"row mt-10"},C={class:"col span-12"},O={class:"row mt-20"},E={class:"col span-6 pt-5"},I={key:4,class:"row mt-10"},V={class:"col span-6"};function z(e,l,a,z,F,x){const S=(0,t.resolveComponent)("Loading"),B=(0,t.resolveComponent)("Banner"),K=(0,t.resolveComponent)("LabeledSelect"),T=(0,t.resolveComponent)("Checkbox"),R=(0,t.resolveComponent)("RadioGroup"),U=(0,t.resolveComponent)("LabeledInput");return e.$fetchState.pending?((0,t.openBlock)(),(0,t.createBlock)(S,{key:0,delayed:!0})):F.errors.length?((0,t.openBlock)(),(0,t.createElementBlock)("div",i,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(F.errors,(e,l)=>((0,t.openBlock)(),(0,t.createElementBlock)("div",{key:l},[(0,t.createVNode)(B,{color:"error",label:x.stringify(e)},null,8,["label"])]))),128))])):((0,t.openBlock)(),(0,t.createElementBlock)("div",s,[(0,t.createElementVNode)("div",r,[(0,t.createElementVNode)("div",o,[(0,t.createVNode)(K,{value:e.value.serverLocation,"onUpdate:value":l[0]||(l[0]=l=>e.value.serverLocation=l),mode:e.mode,options:F.locationOptions,searchable:!0,required:!0,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.location.label")},null,8,["value","mode","options","disabled","label"])]),(0,t.createElementVNode)("div",n,[(0,t.createVNode)(K,{value:e.value.serverType,"onUpdate:value":l[1]||(l[1]=l=>e.value.serverType=l),mode:e.mode,options:F.serverTypeOptions,searchable:!0,required:!0,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.serverType.label")},null,8,["value","mode","options","disabled","label"])])]),(0,t.createElementVNode)("div",d,[(0,t.createElementVNode)("div",c,[(0,t.createVNode)(K,{value:e.value.image,"onUpdate:value":l[2]||(l[2]=l=>e.value.image=l),mode:e.mode,options:F.imageOptions,searchable:!0,required:!0,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.image.label")},null,8,["value","mode","options","disabled","label"])]),(0,t.createElementVNode)("div",u,[(0,t.createElementVNode)("h3",null,(0,t.toDisplayString)(e.t("cluster.machineConfig.hetzner.additionalOptions.label")),1),(0,t.createVNode)(T,{value:e.value.usePrivateNetwork,"onUpdate:value":l[3]||(l[3]=l=>e.value.usePrivateNetwork=l),mode:e.mode,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.usePrivateNetwork.label")},null,8,["value","mode","disabled","label"]),(0,t.createVNode)(T,{value:e.value.disablePublicIpv4,"onUpdate:value":l[4]||(l[4]=l=>e.value.disablePublicIpv4=l),mode:e.mode,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.disablePublicIpv4.label")},null,8,["value","mode","disabled","label"]),(0,t.createVNode)(T,{value:e.value.disablePublicIpv6,"onUpdate:value":l[5]||(l[5]=l=>e.value.disablePublicIpv6=l),mode:e.mode,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.disablePublicIpv6.label")},null,8,["value","mode","disabled","label"])])]),e.value.usePrivateNetwork?((0,t.openBlock)(),(0,t.createElementBlock)("div",h,[(0,t.createElementVNode)("div",v,[(0,t.createVNode)(K,{value:e.value.networks,"onUpdate:value":l[6]||(l[6]=l=>e.value.networks=l),mode:e.mode,options:F.networkOptions,searchable:!0,multiple:!0,required:!0,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.networks.label")},null,8,["value","mode","options","disabled","label"])])])):(0,t.createCommentVNode)("",!0),(0,t.createElementVNode)("div",m,[(0,t.createElementVNode)("div",p,[(0,t.createElementVNode)("h3",null,(0,t.toDisplayString)(e.t("cluster.machineConfig.hetzner.firewallSection.label")),1),(0,t.createVNode)(R,{value:F.firewallMode,"onUpdate:value":l[7]||(l[7]=e=>F.firewallMode=e),name:"firewallMode",disabled:a.disabled,options:[{value:"none",label:e.t("cluster.machineConfig.hetzner.firewallMode.none")},{value:"existing",label:e.t("cluster.machineConfig.hetzner.firewallMode.existing")},{value:"create",label:e.t("cluster.machineConfig.hetzner.firewallMode.create")}],row:!0},null,8,["value","disabled","options"])])]),"existing"===F.firewallMode?((0,t.openBlock)(),(0,t.createElementBlock)("div",b,[(0,t.createElementVNode)("div",w,[(0,t.createVNode)(K,{value:e.value.firewalls,"onUpdate:value":l[8]||(l[8]=l=>e.value.firewalls=l),mode:e.mode,options:F.firewallOptions,searchable:!0,multiple:!0,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.firewalls.label")},null,8,["value","mode","options","disabled","label"])])])):(0,t.createCommentVNode)("",!0),"create"===F.firewallMode?((0,t.openBlock)(),(0,t.createElementBlock)("div",f,[(0,t.createElementVNode)("div",g,[(0,t.createVNode)(U,{value:e.value.firewallName,"onUpdate:value":l[9]||(l[9]=l=>e.value.firewallName=l),mode:e.mode,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.firewallName.label"),placeholder:e.t("cluster.machineConfig.hetzner.firewallName.placeholder")},null,8,["value","mode","disabled","label","placeholder"])]),(0,t.createElementVNode)("div",y,[(0,t.createVNode)(T,{value:e.value.autoCreateFirewallRules,"onUpdate:value":l[10]||(l[10]=l=>e.value.autoCreateFirewallRules=l),mode:e.mode,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.autoCreateFirewallRules.label")},null,8,["value","mode","disabled","label"]),(0,t.createElementVNode)("p",N,(0,t.toDisplayString)(e.t("cluster.machineConfig.hetzner.autoCreateFirewallRules.description")),1)])])):(0,t.createCommentVNode)("",!0),"create"===F.firewallMode&&e.value.autoCreateFirewallRules&&e.value.disablePublicIpv4?((0,t.openBlock)(),(0,t.createElementBlock)("div",k,[(0,t.createElementVNode)("div",C,[(0,t.createVNode)(B,{color:"warning",label:e.t("cluster.machineConfig.hetzner.autoCreateFirewallRules.ipv4Warning")},null,8,["label"])])])):(0,t.createCommentVNode)("",!0),(0,t.createElementVNode)("div",O,[(0,t.createElementVNode)("div",E,[(0,t.createVNode)(T,{value:F.useExistingSshKey,"onUpdate:value":l[11]||(l[11]=e=>F.useExistingSshKey=e),mode:e.mode,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.useExistingSshKey.label")},null,8,["value","mode","disabled","label"])])]),F.useExistingSshKey?((0,t.openBlock)(),(0,t.createElementBlock)("div",I,[(0,t.createElementVNode)("div",V,[(0,t.createVNode)(K,{value:e.value.existingSshKey,"onUpdate:value":l[12]||(l[12]=l=>e.value.existingSshKey=l),mode:e.mode,options:F.sshKeyOptions,searchable:!0,disabled:a.disabled,label:e.t("cluster.machineConfig.hetzner.existingSshKey.label")},null,8,["value","mode","options","disabled","label"])])])):(0,t.createCommentVNode)("",!0)]))}var F=a(23),x=a(6099),S=a(8576),B=a(7058),K=a(6217),T=a(8507),R=a(6408),U=a(9014),A=a(2352),L=a(4364),P={components:{Loading:F.A,LabeledSelect:S.A,Checkbox:B.S,LabeledInput:K.o,RadioGroup:T.z,Banner:A.l},mixins:[x.A],props:{credentialId:{type:String,required:!0},cluster:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1}},async fetch(){this.errors=[];try{this.credentialId&&(this.credential=await this.$store.dispatch("rancher/find",{type:R.k$.CLOUD_CREDENTIAL,id:this.credentialId}))}catch(l){this.credential=null}const e=this.cluster?.metadata?.name;e&&!this.value.clusterId?(this.value.clusterId=e,this.clusterIdAutoSet=!0):e&&this.value.clusterId===e&&(this.clusterIdAutoSet=!0);try{this.locationOptions=await this.$store.dispatch("hetzner/locationOptions",{credentialId:this.credentialId});let e="fsn1";this.locationOptions.find(l=>l.value===e)||(e=this.locationOptions[0]?.value),this.value.serverLocation||(this.value.serverLocation=e),this.serverTypeOptions=await this.$store.dispatch("hetzner/serverTypeOptions",{credentialId:this.credentialId});let l="cx23";this.serverTypeOptions.find(e=>e.value===l)||(l=this.serverTypeOptions.find(e=>e.memoryGb>=4)?.value,l||(l=this.serverTypeOptions[0]?.value)),this.value.serverType||(this.value.serverType=l);const a=this.serverTypeOptions.find(e=>e.value===this.value.serverType),t=a?.architecture||"x86";this.imageOptions=await this.$store.dispatch("hetzner/imageOptions",{credentialId:this.credentialId,architecture:t});let i="ubuntu-24.04";this.imageOptions.find(e=>e.value===i)||(i=this.imageOptions[0]?.value),this.value.image||(this.value.image=i),this.networkOptions=await this.$store.dispatch("hetzner/networkOptions",{credentialId:this.credentialId}),"create"===this.mode&&(this.value.usePrivateNetwork||this.value.networks?.length||(this.value.usePrivateNetwork=!0,this.value.disablePublicIpv6=!0,this.networkOptions.length&&(this.value.networks=[this.networkOptions[0].value]))),this.firewallOptions=await this.$store.dispatch("hetzner/firewallOptions",{credentialId:this.credentialId}),"create"===this.mode&&(this.value.createFirewall||this.value.firewalls?.length||(this.firewallMode="create",this.value.createFirewall=!0,this.value.autoCreateFirewallRules=!0)),this.sshKeyOptions=await this.$store.dispatch("hetzner/sshKeyOptions",{credentialId:this.credentialId}),"create"===this.mode&&(this.useExistingSshKey||this.value.existingSshKey||!this.sshKeyOptions.length||(this.useExistingSshKey=!0,this.value.existingSshKey=this.sshKeyOptions[0].value))}catch(l){L.error("Hetzner machine-config fetch error:",l),this.errors=(0,U.rz)(l)}},data(){let e="none";return this.value?.createFirewall?e="create":this.value?.firewalls&&this.value.firewalls.length>0&&(e="existing"),{credential:null,locationOptions:[],serverTypeOptions:[],imageOptions:[],networkOptions:[],firewallOptions:[],sshKeyOptions:[],useExistingSshKey:!!this.value?.existingSshKey,firewallMode:e,clusterIdAutoSet:!1,errors:[],savedFirewalls:this.value?.firewalls?.length?[...this.value.firewalls]:[],savedFirewallName:this.value?.firewallName||"",savedAutoCreateFirewallRules:this.value?.autoCreateFirewallRules??!0}},watch:{credentialId(){this.$fetch()},"cluster.metadata.name"(e){!e||this.value.clusterId&&!this.clusterIdAutoSet||(this.value.clusterId=e,this.clusterIdAutoSet=!0)},useExistingSshKey(e){e||(this.value.existingSshKey="")},firewallMode(e,l){"existing"===l?this.savedFirewalls=this.value.firewalls?.length?[...this.value.firewalls]:[]:"create"===l&&(this.savedFirewallName=this.value.firewallName||"",this.savedAutoCreateFirewallRules=this.value.autoCreateFirewallRules??!0),"none"===e?(this.value.firewalls=[],this.value.createFirewall=!1,this.value.firewallName="",this.value.autoCreateFirewallRules=!1):"existing"===e?(this.value.createFirewall=!1,this.value.firewallName="",this.value.autoCreateFirewallRules=!1,this.value.firewalls=this.savedFirewalls.length?[...this.savedFirewalls]:[]):"create"===e&&(this.value.firewalls=[],this.value.createFirewall=!0,this.value.firewallName=this.savedFirewallName,this.value.autoCreateFirewallRules=this.savedAutoCreateFirewallRules)},"value.serverType"(e){if(e&&this.serverTypeOptions.length){const l=this.serverTypeOptions.find(l=>l.value===e);l&&this.refreshImages(l.architecture)}}},methods:{stringify:U.As,async refreshImages(e){try{this.imageOptions=await this.$store.dispatch("hetzner/imageOptions",{credentialId:this.credentialId,architecture:e||"x86"}),this.value.image&&!this.imageOptions.find(e=>e.value===this.value.image)&&(this.value.image=this.imageOptions[0]?.value||"")}catch(l){L.error("Error refreshing images for architecture:",e,l)}}}},M=a(7433);const _=(0,M.A)(P,[["render",z]]);var $=_},1177:function(e,l,a){var t={"./classic/metadata.json":9621,"./csp/metadata.json":6471,"./federal/metadata.json":1862,"./harvester/metadata.json":1507,"./rgs/metadata.json":8401,"./suse/metadata.json":7259};function i(e){var l=s(e);return a(l)}function s(e){if(!a.o(t,e)){var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}return t[e]}i.keys=function(){return Object.keys(t)},i.resolve=s,e.exports=i,i.id=1177}}]);
//# sourceMappingURL=hetzner-node-driver-1.0.0.umd.min.machine-config.js.map